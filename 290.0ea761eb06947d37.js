"use strict";(self.webpackChunkfreshcart=self.webpackChunkfreshcart||[]).push([[290],{3679:(h,d,a)=>{a.d(d,{N:()=>m});var u=a(5619),p=a(4769),t=a(9862);let m=(()=>{class l{constructor(n){this._HttpClient=n,this.baseURL="https://ecommerce.routemisr.com/",this.numOfCartItems=new u.X(null),this.userHeader={token:localStorage.getItem("userToken")},null!=localStorage.getItem("userToken")&&this.getAllCartAPI().subscribe({next:o=>{this.numOfCartItems.next(o.numOfCartItems)}})}AddCartAPI(n){return this._HttpClient.post(`${this.baseURL}api/v1/cart`,{productId:n})}updateCartItemsAPI(n,o){return this._HttpClient.put(`${this.baseURL}api/v1/cart/${n}`,{count:o})}getAllCartAPI(){return this._HttpClient.get(`${this.baseURL}api/v1/cart`)}removeCartItemAPI(n){return this._HttpClient.delete(`${this.baseURL}api/v1/cart/${n}`)}clearUserCartAPI(){return this._HttpClient.delete(`${this.baseURL}api/v1/cart`)}onLinePaymentAPI(n,o){return this._HttpClient.post(`${this.baseURL}api/v1/orders/checkout-session/${n}?url=${window.location.origin}`,{shippingAddress:o})}static#t=this.\u0275fac=function(o){return new(o||l)(p.LFG(t.eN))};static#e=this.\u0275prov=p.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})()},5290:(h,d,a)=>{a.r(d),a.d(d,{CartComponent:()=>f});var u=a(6814),p=a(1120),t=a(4769),m=a(3679),l=a(4219);function v(i,C){if(1&i){const e=t.EpF();t.TgZ(0,"div",7)(1,"div",8),t._UZ(2,"img",9),t.qZA(),t.TgZ(3,"div",10)(4,"h1",11),t._uU(5),t.qZA(),t.TgZ(6,"span"),t._uU(7),t.qZA(),t.TgZ(8,"div",12)(9,"span"),t._uU(10),t.qZA(),t.TgZ(11,"div"),t._UZ(12,"i",13),t.TgZ(13,"span"),t._uU(14),t.qZA()()(),t.TgZ(15,"i",14),t.NdJ("click",function(){const s=t.CHM(e).$implicit,_=t.oxw(2);return t.KtG(_.deleteItemBtn(s.product.id))}),t.qZA()(),t.TgZ(16,"div",8)(17,"i",15),t.NdJ("click",function(){const s=t.CHM(e).$implicit,_=t.oxw(2);return t.KtG(_.updateCartBtn(s.product.id,s.count,"plus"))}),t.qZA(),t.TgZ(18,"span"),t._uU(19),t.qZA(),t.TgZ(20,"i",16),t.NdJ("click",function(){const s=t.CHM(e).$implicit,_=t.oxw(2);return t.KtG(_.updateCartBtn(s.product.id,s.count,"Mins"))}),t.qZA()()()}if(2&i){const e=C.$implicit;t.xp6(2),t.Q6J("src",e.product.imageCover,t.LSH),t.xp6(3),t.Oqu(e.product.title),t.xp6(2),t.Oqu(null==e.product.category?null:e.product.category.name),t.xp6(3),t.hij("",e.price,"EGP"),t.xp6(4),t.Oqu(e.product.ratingsAverage),t.xp6(5),t.hij(" ",e.count," ")}}const n=function(i){return["/onlinePayment",i]};function o(i,C){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"h1",3),t._uU(2),t.qZA(),t.TgZ(3,"button",4),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.clearCartBtn())}),t._uU(4,"Clear Cart"),t.qZA(),t.YNc(5,v,21,6,"div",5),t.TgZ(6,"button",6),t._uU(7,"Online Payment"),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(2),t.hij("Totla Price : ",e.totalPrice,""),t.xp6(3),t.Q6J("ngForOf",e.allCartItemsProd),t.xp6(1),t.Q6J("routerLink",t.VKq(3,n,e.cartId))}}function g(i,C){1&i&&(t.TgZ(0,"h3",17),t._uU(1,"Sorry your cart is Empty ^_^"),t.qZA())}let f=(()=>{class i{constructor(e,r){this._CartService=e,this.toastEvokeService=r,this.totalPrice="",this.cartId=""}ngOnInit(){this._CartService.getAllCartAPI().subscribe({next:e=>{this.allCartItemsProd=e.data.products,this.totalPrice=e.data.totalCartPrice,this.cartId=e.data._id},error:e=>this.toastEvokeService.danger("Oppps! ^_^",e.error.message).subscribe()}),localStorage.setItem("currentPage","/cart")}deleteItemBtn(e){this._CartService.removeCartItemAPI(e).subscribe({next:r=>{this.totalPrice=r.data.totalCartPrice,this.allCartItemsProd=r.data.products,this._CartService.numOfCartItems.next(r.numOfCartItems),this.toastEvokeService.success("Successfully!","Product Deleted Successfully").subscribe()},error:r=>this.toastEvokeService.danger("Oppps! ^_^",r.error.message).subscribe()})}updateCartBtn(e,r,c){"plus"==c?this.dummyCount=(Number(r)+1).toString():Number(r)<=1?this.deleteItemBtn(e):this.dummyCount=(Number(r)-1).toString(),this._CartService.updateCartItemsAPI(e,this.dummyCount).subscribe({next:s=>{console.log(s),this.totalPrice=s.data.totalCartPrice,this.allCartItemsProd=s.data.products,this.toastEvokeService.success("Successfully!","Product Quentity Updated Successfully").subscribe()},error:s=>this.toastEvokeService.danger("Oppps! ^_^",s.error.message).subscribe()})}clearCartBtn(){this._CartService.clearUserCartAPI().subscribe({next:e=>{this.allCartItemsProd=[],this.totalPrice="0",this._CartService.numOfCartItems.next(0),this.toastEvokeService.success("Successfully!","your Cart is empty now").subscribe()},error:e=>this.toastEvokeService.danger("Oppps! ^_^",e.error.message).subscribe()})}static#t=this.\u0275fac=function(r){return new(r||i)(t.Y36(m.N),t.Y36(l.nm))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-cart"]],standalone:!0,features:[t.jDz],decls:4,vars:2,consts:[[1,"w-75","mx-auto"],[4,"ngIf","ngIfElse"],["emptyCardmessage",""],[1,"text-center","text-main"],[1,"btn","btn-outline-danger","d-flex","ms-auto","my-1",3,"click"],["class","row align-items-center",4,"ngFor","ngForOf"],["routerLinkActive","router-link-active",1,"btn","bg-main","text-white","d-block",3,"routerLink"],[1,"row","align-items-center"],[1,"col-md-2"],[1,"w-100",3,"src"],[1,"col-md-7"],[1,"h5","text-muted"],[1,"mb-3"],[1,"fa-solid","fa-star","rating-color"],[1,"fa-solid","cursor-pointer","h4","text-danger","fa-trash",3,"click"],[1,"fa-solid","cursor-pointer","text-main","h4","fa-square-plus",3,"click"],[1,"fa-solid","cursor-pointer","text-main","h4","fa-square-minus",3,"click"],[1,"text-center","my-5","text-main"]],template:function(r,c){if(1&r&&(t.TgZ(0,"div",0),t.YNc(1,o,8,5,"div",1),t.YNc(2,g,2,0,"ng-template",null,2,t.W1O),t.qZA()),2&r){const s=t.MAs(3);t.xp6(1),t.Q6J("ngIf",c.allCartItemsProd)("ngIfElse",s)}},dependencies:[u.ez,u.sg,u.O5,p.rH]})}return i})()}}]);